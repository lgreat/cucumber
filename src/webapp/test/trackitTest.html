<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>trackItTest</title>
        <script language="JavaScript" src="http://localhost:8080/res/jsunit/app/jsUnitCore.js"></script>
        <script language="JavaScript" src="http://localhost:8080/res/js/global.js"></script>
        <script language="JavaScript" src="http://localhost:8080/res/js/prototype.js"></script>
        <script language="JavaScript" src="http://localhost:8080/res/js/trackIt.js"></script>

    </head>
<body>

        <script language="JavaScript">



            var testObject = {
                aaa:"value of aaa jfjdjf dkdkd fdkkjdfk kdjfkdjk fjdkjfkd jkdjfd j",
                bbb:"value of bbb jfjdjf dkdkd fdkkjdfk kdjfkdjk fjdkjfkd jkdjfd j",
                ccc:"value of ccc jfjdjf dkdkd fdkkjdfk kdjfkdjk fjdkjfkd jkdjfd j",
                ddd:"value of ddd ffjdjf dkdkd fdkkjdfk kdjfkdjk fjdkjfkd jkdjfd j",
                eee:"value of eee jfjdjf dkdkd fdkkjdfk kdjfkdjk fjdkjfkd jkdjfd j"
            }

            function setUp(){
    
                createCookie(clickCapture.cookieName, "");
                clickCapture.dataObject = undefined;

            }

            function testCapture(){
                var testEntity = "TestEntity";
                var testValue = "testValue";

                clickCapture.capture(testEntity, testValue);

                var result = subCookie.getObject(clickCapture.cookieName);
                assertNotUndefined("expect the cookie object written by clickCapture", result);
                assertEquals("compare the values", testValue, result[testEntity]);

            }

            function testGetData(){


                subCookie.setObject(clickCapture.cookieName, testObject);

                clickCapture.getData();

                assertNotNull("expect clickCapture.dataObject to have the data written by subCookie",clickCapture.dataObject);

                assertEquals(testObject.aaa, clickCapture.dataObject.aaa);
                assertEquals(testObject.bbb, clickCapture.dataObject.bbb);
                assertEquals(testObject.ccc, clickCapture.dataObject.ccc);
                assertEquals(testObject.ddd, clickCapture.dataObject.ddd);
                assertEquals(testObject.eee, clickCapture.dataObject.eee);


                /*
                 * the following fails when prototype.js is loaded

                var count = 0;
                for( var o in clickCapture.dataObject){

                    count++;
                    info(o + "\t" + clickCapture.dataObject[o]);

                }
                assertEquals("and no additional properties exist ", 5, count);

                 */
            }

            function testClearData(){


                subCookie.setObject(clickCapture.cookieName, testObject);

                clickCapture.getData();

                clickCapture.clearData();

                // dataObject should still contain the data values from the cookie


                assertNotNull("expect clickCapture.dataObject to have the data written by subCookie",clickCapture.dataObject);

                assertEquals(testObject.aaa, clickCapture.dataObject.aaa);
                assertEquals(testObject.bbb, clickCapture.dataObject.bbb);
                assertEquals(testObject.ccc, clickCapture.dataObject.ccc);
                assertEquals(testObject.ddd, clickCapture.dataObject.ddd);
                assertEquals(testObject.eee, clickCapture.dataObject.eee);


                // the cookie should be cleared

                var result = subCookie.getObject(clickCapture.cookieName);
                info("result: '" + result + "'");
                
                assertNull(result);

            }

            

        </script>
</body>
</html>