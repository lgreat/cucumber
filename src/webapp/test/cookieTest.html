<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>cookieTest</title>
        <script language="JavaScript" src="http://localhost:8080/res/jsunit/app/jsUnitCore.js"></script>
        <script language="JavaScript" src="http://localhost:8080/res/js/global.js"></script>
        <script language="JavaScript" src="http://localhost:8080/res/js/prototype.js"></script>

    </head>
<body>

        <script language="JavaScript">

            var cookieName;

            function setUp(){

                cookieName = "TestThatCookie" ;
                createCookie(cookieName, "");

            }

            function testSetProperty(){
                var testPropertyName = "testProp";
                var testPropertyValue = "this is a test value";

                //setObjectProperty: function(cookieName, propertyName, propertyValue, days)

                subCookie.setObjectProperty(cookieName, testPropertyName, testPropertyValue );

                var cookieObject = subCookie.getObject(cookieName)  ;
                info(cookieObject[testPropertyName]) ;
                
                var result = cookieObject[testPropertyName];

                assertEquals(testPropertyValue, result);
            }

            function testDeleteObjectProperty(){
                //deleteObjectProperty: function(cookieName, propertyName, days)
                var testPropertyName = "testProp";

                var testObject = {b:"23", c:"the story of my cat", testProp:"some value"};

                subCookie.setObject(cookieName,testObject);

                var result = subCookie.getObject(cookieName);
                assertEquals("Just proving it exists","some value", result[testPropertyName]);

                subCookie.deleteObjectProperty(cookieName, testPropertyName );

                result = subCookie.getObject(cookieName);

                for(var o in result){
                    info(o + ", " + result[o]);
                }

                assertUndefined("the test property should be gone" , result[testPropertyName]);
                assertEquals("prop b should be there", testObject.b, result.b);
                assertEquals("prop c should be there", testObject.c, result.c);

                var count = 0;
                for( var o in result){
                    count++;
                }
                assertEquals("and no additional properties exist ", 2, count);               
            }

            function testSetGetObject(){
                //setObject: function(cookieName,subcookieObj,days)

                var testObject = {b:"23", c:"the story of my cat"};

                subCookie.setObject(cookieName,testObject);

                var result = subCookie.getObject(cookieName);

                assertNotUndefined("Expect to get the object that was just written",result);
                //assertEquals(testObject, result);

                assertEquals(testObject.b, result.b);
                assertEquals(testObject.c, result.c);

                var count = 0;
                for( var o in result){
                    count++;
                }
                assertEquals("The number of properties to be ", 2, count);

            }

            function testSetGetObject_withNull(){
                //setObject: function(cookieName,subcookieObj,days)

                var testObject = {b:"23", c:"the story of my cat"};

                subCookie.setObject(cookieName,testObject);

                var result = subCookie.getObject(cookieName);

                assertNotUndefined("Expect to get the object that was just written",result);
                //assertEquals(testObject, result);

                assertEquals(testObject.b, result.b);
                assertEquals(testObject.c, result.c);

                // the action

                subCookie.setObject(cookieName);

                result = subCookie.getObject(cookieName);
                info("result: '" + result + "'");
                assertNull("expect nothing in return", result)  ;


            }

            function testSetGetObject_withEmptyObject(){
                //setObject: function(cookieName,subcookieObj,days)

                var testObject = {b:"23", c:"the story of my cat"};

                subCookie.setObject(cookieName,testObject);

                var result = subCookie.getObject(cookieName);

                assertNotUndefined("Expect to get the object that was just written",result);
                //assertEquals(testObject, result);

                assertEquals(testObject.b, result.b);
                assertEquals(testObject.c, result.c);

                // the action

                subCookie.setObject(cookieName, {});

                result = subCookie.getObject(cookieName);
                info("result: '" + result + "'");
                assertNull("expect nothing in return", result)  ;


            }


            function testSetGetObject_withEmptyArray(){
                //setObject: function(cookieName,subcookieObj,days)

                var testObject = {b:"23", c:"the story of my cat"};

                subCookie.setObject(cookieName,testObject);

                var result = subCookie.getObject(cookieName);

                assertNotUndefined("Expect to get the object that was just written",result);
                //assertEquals(testObject, result);

                assertEquals(testObject.b, result.b);
                assertEquals(testObject.c, result.c);

                // the action

                subCookie.setObject(cookieName, new Array());

                result = subCookie.getObject(cookieName);
                info("result: '" + result + "'");

                var count = 0;
                for( var o in result){
                    info("item in object: '" + o + "', " + result[o]);
                    count++;
                }

                assertNull("expect nothing in return", result)  ;

                assertEquals("expecting an empty object", 0, count);


            }



              
        </script>
</body>
</html>