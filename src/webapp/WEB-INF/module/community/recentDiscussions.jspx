<?xml version="1.0" encoding="UTF-8"?>
<jsp:root version="2.0"
          xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:link="urn:www.greatschools.org/taglib/link"
          xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
          xmlns:community="urn:jsptagdir:/WEB-INF/tags/community"
          xmlns:gsweb="gstaglib">

    <c:if test="${!empty requestScope.discussionBoard and !empty requestScope.discussions}">
        <c:set var="fullUri" value="${requestScope.discussionBoard.fullUri}"/>

        <c:choose>
            <c:when test="${style eq 'fall2009'}">

                <div id="recentDiscussions" class="box">
                    <div class="inner cleared">
                        <div class="content gainlayout">
                            <h2>${requestScope.discussionBoard.title}</h2>
                            <c:forEach var="discussion" items="${requestScope.discussions}">
                                <div class="discussionHolder sdrb clearfix">
                                    <div class="avatar fltlft">
                                        <link:userProfile user="${discussion.user}" anonymous="${discussion.anonymous}">
                                            <community:avatar user="${discussion.user}" width="48" height="48"
                                                              cssClass="fltlft" cssStyle="border: 1px solid #c6c6c6;"
                                                              anonymous="${discussion.anonymous}"/>
                                        </link:userProfile>
                                    </div>
                                    <!-- end avatar -->
                                    <div class="discussionTopic fltlft">
                                        <h4 class="text3"><link:discussion discussionId="${discussion.id}"
                                                                           fullUri="${fullUri}"
                                                                           styleClass="text3">${discussion.title}</link:discussion>
                                        </h4>

                                        <span class="smallAlertTextBoldNeutral">
                                        <link:userProfile user="${discussion.user}"
                                                          styleClass="smallAlertTextBoldNeutral"
                                                          anonymous="${discussion.anonymous}">
                                            <community:screenName userContent="${discussion}"/>
                                        </link:userProfile>
                                        </span>

                                        <span class="smallText1"> ${gsweb:detailedPeriodBetweenDates(discussion.dateCreated,requestScope.currentDate)}</span>

                                        <p>
                                            <community:userContentTeaserText
                                                    textToDisplay="${discussion.body}"
                                                    minLength="143" maxLength="163"
                                                    discussionId="${discussion.id}"
                                                    discussionFullUri="${fullUri}"
                                                    numReplies="${discussion.totalReplies}"
                                                    textSpanClass="text3"
                                                    linkClass="text3"/>
                                        </p>
                                    </div>
                                    <!-- end discussionTopic -->
                                    <br class="clearfloat"/>
                                </div>
                                <!-- end discussionHolder -->
                            </c:forEach>

                            <div class="fltlft">
                                <a class="btn25 startADiscussion" href="#" onclick="this.blur();return false">
            <span class="lftDoor25">
                <span class="rtDoor25">
                    <span class="sprite community fltlft martop_2 padrt_5"><!-- icon --></span>Start a conversation</span>
            </span>
                                </a>
                                <community:startADiscussionHover loginRedirectUrl="${requestScope.loginRedirectUrl}"
                                                                 openElementJQuerySelector=".startADiscussion"
                                                                 topicCenterId="${requestScope.discussionBoard.topicCenterId}"
                                                                 discussionBoardId="${requestScope.discussionBoard.contentKey.identifier}"/>
                            </div>
                            <!-- end start a discussion button -->

                            <p class="fltrt"><link:cmsContent contentKey="${requestScope.discussionBoard.contentKey}"
                                                              fullUri="${fullUri}">
                                <span class="text3_230">More conversations </span>
                                <span class="alertDoubleArrow">&amp;raquo;</span>
                            </link:cmsContent></p>
                            <br class="clearfloat"/>
                        </div>
                        <!-- end content -->
                    </div>
                    <!-- end inner -->
                </div>
                <!-- end recentDiscussions -->

            </c:when>
            <c:otherwise>

                <div id="recentDiscussions" class="box">
                    <div class="content gainlayout">
                        <h3 class="title2-d61">Talk about it</h3>
                        <c:forEach var="discussion" items="${requestScope.discussions}">
                            <div class="discussionHolder clearfix">
                                <div class="avatar fltlft">
                                    <link:userProfile user="${discussion.user}" anonymous="${discussion.anonymous}">
                                        <community:avatar user="${discussion.user}" width="48" height="48"
                                                          cssClass="fltlft" cssStyle="border: 1px solid #c6c6c6;"
                                                          anonymous="${discussion.anonymous}"/>
                                    </link:userProfile>
                                </div>
                                <!-- end avatar -->
                                <div class="discussionTopic text3 fltlft">
                                    <h4><link:discussion discussionId="${discussion.id}"
                                                         fullUri="${fullUri}"
                                                         styleClass="text3">${discussion.title}</link:discussion>
                                    </h4>

                                    <span class="smallAlertTextBoldNeutral">
                                    <link:userProfile user="${discussion.user}"
                                                      anonymous="${discussion.anonymous}"
                                                      styleClass="smallAlertTextBoldNeutral">
                                        <community:screenName userContent="${discussion}"/>
                                    </link:userProfile>
                                    </span>
                                    <span class="smallText1"> ${gsweb:detailedPeriodBetweenDates(discussion.dateCreated,requestScope.currentDate)}</span>

                                    <p>
                                        <community:userContentTeaserText
                                                textToDisplay="${discussion.body}"
                                                minLength="143" maxLength="163"
                                                discussionId="${discussion.id}"
                                                discussionFullUri="${fullUri}"
                                                numReplies="${discussion.totalReplies}"
                                                textSpanClass="text3"
                                                linkClass="text3"/>
                                    </p>
                                </div>
                                <!-- end discussionTopic -->
                                <br class="clearfloat"/>
                            </div>
                            <!-- end discussionHolder -->
                        </c:forEach>

                        <div class="fltlft">
                            <a class="btn25 startADiscussion" href="#" onclick="this.blur();return false">
            <span class="lftDoor25">
                <span class="rtDoor25"><span class="sprite community fltlft martop_2 padrt_5"><!-- icon --></span>Start a conversation</span>
            </span>
                            </a>
                            <community:startADiscussionHover loginRedirectUrl="${requestScope.loginRedirectUrl}"
                                                             openElementJQuerySelector=".startADiscussion"
                                                             topicCenterId="${requestScope.discussionBoard.topicCenterId}"/>
                        </div>
                        <!-- end start a discussion button -->

                        <p class="fltrt"><link:cmsContent contentKey="${requestScope.discussionBoard.contentKey}"
                                                          fullUri="${fullUri}">
                            <span class="text3_230">More conversations </span>
                            <span class="alertDoubleArrow">&amp;raquo;</span>
                        </link:cmsContent></p>
                        <br class="clearfloat"/>
                    </div>
                    <!-- end content -->
                </div>
                <!-- end recentDiscussions -->

            </c:otherwise>
        </c:choose>

    </c:if>
</jsp:root>