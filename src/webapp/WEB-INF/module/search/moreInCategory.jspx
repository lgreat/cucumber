<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
          xmlns="http://www.w3c.org/1999/xhtml"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:gsweb="gstaglib"
          xmlns:pageHelper="urn:jsptagdir:/WEB-INF/tags/pageHelper"
          xmlns:link="urn:www.greatschools.net/taglib/link">

    <c:if test="${not empty mainResults}">
        <pageHelper:externalCss file="/res/css/content/moreInCategory.css"/>

        <c:choose>
            <c:when test="${style eq 'fall2009'}">

                <div class="module">
                    <div class="header">
                        <span class="title1white">
                            More in
                            <c:choose>
                                <c:when test="${fn:length(categories) eq 1}">
                                    ${gsweb:toLowerCase(category.name)}
                                </c:when>
                                <c:otherwise>
                                    this topic
                                </c:otherwise>
                            </c:choose>
                        </span>
                    </div> <!-- end header -->
                    <c:choose>
                        <c:when test="${total lt maxResults}">
                            <c:set var="actualMax" value="${total}"/>
                        </c:when>
                        <c:otherwise>
                            <c:set var="actualMax" value="${maxResults}"/>
                        </c:otherwise>
                    </c:choose>

                    <div class="body2bg">
                        <ul class="morein text3">
                            <c:forEach var="result" items="${mainResults}" varStatus="status">

                                <c:if test="${status.count le actualMax}">

                                    <c:choose>
                                        <c:when test="${status.count eq actualMax}">
                                            <c:set var="className" value="lastone"/>
                                        </c:when>
                                        <c:otherwise>
                                            <c:set var="className" value=""/>
                                        </c:otherwise>
                                    </c:choose>

                                    <li class="moreinItem ${className}">
                                        <link:cmsContent contentKey="${result.id}" fullUri="${result.fullUri}">
                                            <c:out value="${result.headline}" escapeXml="false"/>
                                        </link:cmsContent>
                                    </li>

                                </c:if>
                            </c:forEach>
                        </ul>

                        <c:if test="${total gt maxResults}">
                            <p class="moreinItem">
                            <c:choose>
                                <c:when test="${fn:length(categories) eq 1}">
                                    <link:cmsCategoryBrowse topicIDs="${category.id}" language="${param.language}">
                                        <span class="text3">More </span>
                                        <span class="alertDoubleArrow">&amp;raquo;</span>
                                    </link:cmsCategoryBrowse>
                                </c:when>
                                <c:otherwise>
                                    <link:cmsCategoryBrowse topicIDs="${topicIds}" subjectIDs="${subjectIds}"
                                                            gradeIDs="${gradeIds}" language="${param.language}">
                                        <span class="text3">More </span>
                                        <span class="alertDoubleArrow">&amp;raquo;</span>
                                    </link:cmsCategoryBrowse>
                                </c:otherwise>
                            </c:choose>
                            </p>
                        </c:if>
                    </div> <!-- end body2bg -->
                </div>
                <!-- end module -->

            </c:when>
            <c:otherwise>
                <div id="cmsRelatedArticles">
                    <div>
                        <img width="300" height="15" alt="" src="/res/img/box/morein_top.gif"/>
                    </div>
                    <div id="cmsRelatedArticleContent">
                        <h2>
                            More in
                            <c:choose>
                                <c:when test="${fn:length(categories) eq 1}">
                                    ${gsweb:toLowerCase(category.name)}
                                </c:when>
                                <c:otherwise>
                                    this topic
                                </c:otherwise>
                            </c:choose>
                        </h2>

                        <c:choose>
                            <c:when test="${total lt maxResults}">
                                <c:set var="actualMax" value="${total}"/>
                            </c:when>
                            <c:otherwise>
                                <c:set var="actualMax" value="${maxResults}"/>
                            </c:otherwise>
                        </c:choose>

                        <c:forEach var="result" items="${mainResults}" varStatus="status">

                            <c:if test="${status.count le actualMax}">

                                <c:choose>
                                    <c:when test="${status.count eq actualMax}">
                                        <c:set var="className" value="lastone"/>
                                    </c:when>
                                    <c:otherwise>
                                        <c:set var="className" value=""/>
                                    </c:otherwise>
                                </c:choose>

                                <div class="${className}">
                                    <link:cmsContent contentKey="${result.id}" fullUri="${result.fullUri}">
                                        <c:out value="${result.headline}" escapeXml="false"/>
                                    </link:cmsContent>
                                </div>

                            </c:if>
                        </c:forEach>

                        <c:if test="${total gt maxResults}">
                            <c:choose>
                                <c:when test="${fn:length(categories) eq 1}">
                                    <link:cmsCategoryBrowse topicIDs="${category.id}" language="${param.language}"><span
                                            class="bolder">More  &amp;raquo;</span></link:cmsCategoryBrowse>
                                </c:when>
                                <c:otherwise>
                                    <link:cmsCategoryBrowse topicIDs="${topicIds}" subjectIDs="${subjectIds}"
                                                            gradeIDs="${gradeIds}" language="${param.language}"><span
                                            class="bolder">More  &amp;raquo;</span></link:cmsCategoryBrowse>
                                </c:otherwise>
                            </c:choose>
                        </c:if>
                    </div>
                    <!-- end #cmsRelatedArticleContent -->
                    <div>
                        <img width="300" height="15" alt="" src="/res/img/box/morein_bottom.gif"/>
                    </div>
                </div>
                <!-- end #cmsRelatedArticles -->
            </c:otherwise>
        </c:choose>

    </c:if>
</jsp:root>