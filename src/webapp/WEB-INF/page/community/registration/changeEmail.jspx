<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:spring="http://www.springframework.org/tags"
          xmlns:mod="urn:jsptagdir:/WEB-INF/tags/mod"
          xmlns:pageHelper="urn:jsptagdir:/WEB-INF/tags/pageHelper"
          xmlns:gsweb="gstaglib"
          xmlns="http://www.w3.org/1999/xhtml" version="2.0">
    <jsp:directive.page import="gs.web.util.context.SessionContextUtil"/>
    <jsp:directive.page contentType="text/html"/><html>
  <pageHelper:setPathway pathway="COMMUNITY_LANDING"/>
  <head>
      <pageHelper:externalCss file="/res/css/community/registration/changeEmail.css"/>
      <title>Change Email - GreatSchools</title>
      <jsp:scriptlet>
          String comHost =
                  SessionContextUtil.getSessionContext(request).getSessionContextUtil().getCommunityHost(request);
          String dashboardUrl = "http://" + comHost + "/dashboard";
          request.setAttribute("dashboardUrl", dashboardUrl);
      </jsp:scriptlet>
  </head>
  <gsml:body adPageName="changeEmail">
      <![CDATA[
      <!--[if IE]>
        <style type="text/css">
          #outline ul li .errorText {
            top: 8px;
          }
        </style>
      <![endif]-->
      ]]>

      <div id="outline"><!-- creates darker blue outer outline -->
          <h2>Update My Email Address</h2>

          <a href="${dashboardUrl}"
             id="dashboardLink">Return to my dashboard &gt;</a>

          <gsweb:form action="/community/changeEmail.page" method="post">
              <ul>
                  <li>
                      <label>Current email address:</label>
                      <address>${requestScope.context.email}</address>
                  </li>
                  <li>
                      <label for="newEmailField">New email address</label>
                      <spring:bind path="emailCmd.newEmail">
                          <input id="newEmailField" type="text" name="${status.expression}"
                                 value="${status.value}"/>
                      </spring:bind>
                      <!-- hack because the built in email validator rejects the field named "email" -->
                      <spring:hasBindErrors name="emailCmd">
                          <spring:bind path="emailCmd.email">
                              <c:if test="${status.errorMessage gt '' or status.errorCode gt ''}">
                                  <gsml:img src="/res/img/bullet/icon_warning_12x12.gif"
                                            alt="Error" styleClass="errorImage"/>
                                  <p class="errorText"><spring:message code="${status.errorCode}" text="${status.errorMessage}"/></p>
                              </c:if>
                          </spring:bind>
                          <spring:bind path="emailCmd.newEmail">
                              <c:if test="${status.errorMessage gt '' or status.errorCode gt ''}">
                                  <gsml:img src="/res/img/bullet/icon_warning_12x12.gif"
                                            alt="Error" styleClass="errorImage"/>
                                  <p class="errorText"><spring:message code="${status.errorCode}" text="${status.errorMessage}"/></p>
                              </c:if>
                          </spring:bind>
                      </spring:hasBindErrors>
                  </li>
                  <li>
                      <label for="confirmNewEmailField">Re-type email address</label>
                      <spring:bind path="emailCmd.confirmNewEmail">
                          <!-- disable browser auto-complete for this field -->
                          <input id="confirmNewEmailField" type="text" name="${status.expression}"
                                 value="${status.value}" autocomplete="off"/>
                      </spring:bind>
                  </li>
                  <li>
                      <gsml:inputImage src="/res/img/community/registration/cancel.gif"
                                       alt="Cancel" name="cancel"
                                       id="cancelButton"/>
                      <gsml:inputImage src="/res/img/community/registration/savebutton.gif"
                                       alt="Save" name="submit"
                                       id="submitButton"/>
                  </li>
              </ul>
          </gsweb:form>
      </div>
      <!-- end: outline -->
      <mod:tracking pageName="Change Email"
                    pageType="account"
                    hier1="Account,Change Email"/>
  </gsml:body>
</html>
</jsp:root>