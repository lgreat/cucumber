<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="1.2"
          xmlns="http://www.w3c.org/1999/xhtml"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:display="urn:jsptld:http://displaytag.sf.net"
        >
    <jsp:directive.page import="gs.data.admin.batch.BatchLog"/>

    <jsp:scriptlet>
        request.setAttribute("decorator", new org.displaytag.decorator.TableDecorator() {
            public String addRowClass() {
                BatchLog log = (BatchLog) getCurrentRowObject();
                if (!log.getSucceeded().booleanValue()) {
                    return "error";
                }
                if (log.getFinish() == null) {
                    return "running";
                }
                return null;
            }
        });
    </jsp:scriptlet>

    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <jsp:output doctype-root-element="html"
                doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN"
                doctype-system="http://www.w3c.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>
    <jsp:directive.page contentType="text/html"/>

    <head>
        <title>GreatSchools GSBatch Status Page</title>
        <gsml:url var="displayTagCss" value="/res/css/displaytag/displaytag.css"/>
        <link rel="stylesheet" type="text/css" href="${displayTagCss}"></link>
        <meta http-equiv="Refresh" content="30"></meta>
    </head>

    <body>
    <h1>GSBatch Status Page</h1>

    <c:if test="${!overview}"> 
    <a href="batch.page">Home</a>
    </c:if>

    <display:table name="batchlogs" class="batchlogs" requestURI="batch.page"
                   defaultsort="${overview?'2':'1'}" defaultorder="${overview?'ascending':'descending'}" export="true" sort="list" pagesize="20" decorator="decorator">
        <display:column property="id" title="ID" sortable="true"></display:column>
        <display:column href="batch.page" paramId="name" paramProperty="name" property="name" title="Name" sortable="true"></display:column>
        <display:column property="text" title="Text" sortable="true" maxLength="100"></display:column>
        <display:column property="start" title="Started" sortable="true" sortProperty="start"></display:column>
        <display:column property="finish" title="Finished" sortable="true" sortProperty="finish"></display:column>
    </display:table>

    </body>
    </html>
</jsp:root>

