<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:ad="urn:jsptagdir:/WEB-INF/tags/ad"
          xmlns:link="urn:www.greatschools.org/taglib/link"
          xmlns:mod="urn:jsptagdir:/WEB-INF/tags/mod"
          xmlns:gsweb="gstaglib"
          xmlns:pageHelper="urn:jsptagdir:/WEB-INF/tags/pageHelper"
          xmlns="http://www.w3.org/1999/xhtml" version="2.0">
    <jsp:directive.page contentType="text/html; charset=UTF-8"/>
    <jsp:output doctype-root-element="html"
                doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN"
                doctype-system="http://www.w3c.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>
    <html>
    <head>
        <pageHelper:externalCss file="/res/css/brand.css"/>
        <pageHelper:externalCss file="/res/css/school/allInState.css"/>
        <meta name="description" content="${title}"/>
        <title>${title}</title>

        <c:choose>
            <c:when test="${type eq 'city'}">
                <c:set var="thing" value="cities" />
                <c:set var="path" value="/schools/cities/" />
                <c:set var="heading" value="${state.longName} School Information by City" />
                <c:set var="pageName" value="All Cities in State" />
                <ad:setSlotPrefix slotPrefix="All_Cities_in_State"/>
            </c:when>
            <c:when test="${type eq 'district'}">
                <c:set var="thing" value="school districts" />
                <c:set var="path" value="/schools/districts/" />
                <c:set var="heading" value="${state.longName} School Districts" />
                <c:set var="pageName" value="All Districts in State" />
                <ad:setSlotPrefix slotPrefix="All_Districts_in_State"/>
            </c:when>
            <c:otherwise>
                <c:set var="thing" value="schools" />
                <c:set var="path" value="/schools/" />
                <c:set var="heading" value="All schools in ${state.longName}" />
                <c:set var="pageName" value="All Schools in State" />
                <ad:setSlotPrefix slotPrefix="All_Schools_in_State"/>
            </c:otherwise>
        </c:choose>
        <script type="text/javascript">
            var stateMap = {"AK":"Alaska","AL":"Alabama","AR":"Arkansas","AZ":"Arizona",
                "CA":"California","CO":"Colorado","CT":"Connecticut","DC":"Washington_DC",
                "DE":"Delaware","FL":"Florida","GA":"Georgia","HI":"Hawaii","IA":"Iowa",
                "ID":"Idaho","IL":"Illinois","IN":"Indiana","KS":"Kansas","KY":"Kentucky",
                "LA":"Louisiana","MA":"Massachusetts","MD":"Maryland","ME":"Maine","MI":"Michigan",
                "MN":"Minnesota","MO":"Missouri","MS":"Mississippi","MT":"Montana",
                "NC":"North_Carolina","ND":"North_Dakota","NE":"Nebraska","NH":"New_Hampshire",
                "NJ":"New_Jersey","NM":"New_Mexico","NV":"Nevada","NY":"New_York",
                "OH":"Ohio","OK":"Oklahoma","OR":"Oregon","PA":"Pennsylvania",
                "RI":"Rhode_Island","SC":"South_Carolina","SD":"South_Dakota",
                "TN":"Tennessee","TX":"Texas","UT":"Utah","VA":"Virginia","VT":"Vermont",
                "WA":"Washington","WI":"Wisconsin","WV":"West_Virginia","WY":"Wyoming"};
        </script>
    </head>
    <gsml:body adPageName="allSchoolsInState" pageLayout="nocol">
    <div id="outer">
        <div id="top">
            <div id="navLinks">
                <link:allSchoolsInState state="${state}" styleClass="${type eq 'school' ? 'active' : ''}">All schools in ${state.longName}</link:allSchoolsInState>
                <a href="/schools/cities/${fn:replace(state.longName, ' ', '_')}/${state.abbreviation}" class="${type eq 'city' ? 'active' : ''}">All cities in ${state.longName}</a>
                <a href="/schools/districts/${fn:replace(state.longName, ' ', '_')}/${state.abbreviation}" class="${type eq 'district' ? 'active' : ''}">${state.longName} School Districts</a>
            </div>

            <div id="pageHeading"><h1>${heading}</h1></div>

            <c:if test="${!requestScope.context.crawler}">
            <div id="changeState">
                Show me ${thing} in a different state:
                <gsweb:stateSelector useNoState="false"
                                     noStateLabel="--"
                                     onChange="document.location='${path}'+ stateMap[this.options[this.selectedIndex].value] + '/' + this.options[this.selectedIndex].value"
                                     usingLongNames="false"
                                     styleId="changeStateSelector"
                                     state="${state}" styleClass="stateSelect"/>
            </div>
            </c:if>

            <div class="pageLinks">${links}</div>
        </div>
        <div>
            <div class="tableColumn fltlft">
                <table id="items" cellpadding="0" cellspacing="0">
                    <tr>
                        <c:if test="${type eq 'school'}">
                            <th>School name</th>
                        </c:if>
                        <c:if test="${type eq 'district'}">
                            <th>District name</th>
                        </c:if>
                        <th>City</th>
                        <c:if test="${type ne 'city'}">
                            <th>County name</th>
                        </c:if>
                    </tr>
                    <c:forEach var="data" items="${list}">
                        <tr>
                            <c:if test="${type eq 'school'}">
                                <td>
                                    <link:schoolProfileOverview school="${data.school}">
                                        <c:out value="${data.name}" escapeXml="true"/>
                                    </link:schoolProfileOverview>
                                </td>
                            </c:if>
                            <c:if test="${type eq 'district'}">
                                <td>
                                    <link:districtHome district="${data.district}">
                                        <c:out value="${data.name}" escapeXml="true"/>
                                    </link:districtHome>
                                </td>
                            </c:if>
                            <c:if test="${type eq 'city'}">
                                <td>
                                    <gsml:a href="/city/${fn:replace(data.city, ' ', '_')}/${state.abbreviation}">
                                        <c:out value="${data.name}" escapeXml="true"/> schools
                                    </gsml:a>
                                </td>
                            </c:if>
                            <c:if test="${type ne 'city'}">
                                <td>${data.city}</td>
                                <td>${data.county}</td>
                            </c:if>
                        </tr>
                    </c:forEach>
                </table>
            </div>
            <div class="adColumn fltlft">
                <!--<c:if test="${type eq 'city'}">-->
                <div class="sponsor_ad"><ad:AboveFold_300x250/></div>
                <!--</c:if>-->
            </div>
            <br class="clearfloat"/>
        </div>
        <div class="pageLinks">
            ${links}
        </div>
        <jsp:include page="/test/testScoreLandingLinks.module">
            <jsp:param name="state" value="${state}"/>
        </jsp:include>
    </div>

    <mod:tracking pageName="${pageName}" hier1="Search,Browse"/>
    </gsml:body>
    </html>
</jsp:root>
