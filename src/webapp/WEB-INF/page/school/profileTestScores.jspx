<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns="http://www.w3.org/1999/xhtml" version="2.0"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:mod="urn:jsptagdir:/WEB-INF/tags/mod"
          xmlns:testDisplay="urn:jsptagdir:/WEB-INF/tags/school/profile/testDisplay"
        >
    <c:choose>
        <c:when test="${! empty testScores}">
            <c:set var="dataNAText" value="Data not available"/>

            <div class="grid_16 alpha omega">
                <div class="fl standard_1-3">
                    <!--Display the test dropdowns-->
                    <div class="hd">
                        <label for="js_testSelect" class="medium_bold mhs">
                            See results for:
                        </label>
                        <select id="js_testSelect">
                            <c:forEach var="testToGrades" items="${testScores}">
                                <option class="${testToGrades.hideGradesNav ? 'js_hideGrades' : ''}"
                                        value="${testToGrades.testDataTypeId}${testToGrades.isSubgroup eq true ?'_subgroup' : ''}">
                                    ${testToGrades.displayName}${testToGrades.isSubgroup eq true ?' by subgroup' : ''}
                                </option>
                            </c:forEach>
                        </select>
                    </div>
                </div>
                <div class="grid_16 alpha omega clearfix">
                    <div class="mod standard_1-4">
                        <div class="inner">
                            <div class="bd clearfix mal">
                                <h3 class="" id="js_testLabelHeader"><!-- not empty --></h3>

                                <div class="alpha grid_4 omega fl" id="js_testScoresGrades">
                                    <p class="medium_bold loud mbs"><strong>Grade level</strong></p>
                                    <!--Display the grades for the test selected-->
                                    <c:forEach var="testToGrades" items="${testScores}">

                                        <div id="js_${testToGrades.testDataTypeId}${testToGrades.isSubgroup eq true ?'_subgroup' : ''}_grades"
                                             class="js_grades dn">

                                            <c:forEach var="gradeToSubjects" items="${testToGrades.grades}">
                                                <div class="small bottom"
                                                     style="padding:3px 5px; width:90%; background:#FFFFFF;">
                                                    <a id="js_${testToGrades.testDataTypeId}${testToGrades.isSubgroup eq true ?'_subgroup' : ''}${gradeToSubjects.jsFriendlyGradeLabel}"
                                                       class="js_grade"
                                                       style="text-decoration:none;"
                                                       href="javascript:void(0);">${gradeToSubjects.gradeLabel}</a>
                                                </div>
                                            </c:forEach>
                                        </div>
                                    </c:forEach>
                                </div>
                                <div class="alpha grid_11 omega fr clearfix" id="js_testScoresValues">
                                    <!--Display the data for the test and grade selected-->
                                    <c:forEach var="testToGrades" items="${testScores}">
                                        <c:set var="isSpecialTest" value="${testToGrades.displayType eq 'oh_value_added'}"/>
                                        <c:choose>
                                            <c:when test="${isSpecialTest}">
                                                <div id="js_${testToGrades.testDataTypeId}"
                                                     class="js_specialTests dn clearfix">
                                                    <testDisplay:ohValueAdded testToGrades="${testToGrades}"/>
                                                </div>
                                            </c:when>
                                            <c:otherwise>
                                                <c:forEach var="gradeToSubjects" items="${testToGrades.grades}">
                                                    <c:if test="${!isSpecialTest}">
                                                        <div id="js_${testToGrades.testDataTypeId}${testToGrades.isSubgroup eq true ?'_subgroup' : ''}${gradeToSubjects.jsFriendlyGradeLabel}_subjects"
                                                             class="js_subjects dn clearfix">
                                                            <c:forEach var="subjectToYears" items="${gradeToSubjects.subjects}">
                                                                <c:set var="scalesUsed"><div class='smaller fr'><!-- do not display --></div></c:set>
                                                                <c:choose>
                                                                    <c:when test="${testToGrades.displayType eq 'sentence'}">
                                                                        <testDisplay:sentence subjectToYears="${subjectToYears}"
                                                                                              state="${school.databaseState}"/>
                                                                    </c:when>
                                                                    <c:when test="${fn:startsWith(testToGrades.displayType, 'ca_api')}">
                                                                        <testDisplay:caApi
                                                                                subjectToYears="${subjectToYears}"/>
                                                                    </c:when>
                                                                    <c:when test="${fn:startsWith(testToGrades.displayType, 'nyc_progress_report')}">
                                                                        <testDisplay:nycProgressReport
                                                                                subjectToYears="${subjectToYears}"/>
                                                                    </c:when>
                                                                    <c:when test="${testToGrades.isSubgroup}">
                                                                        <testDisplay:subgroup subjectToYears="${subjectToYears}" dataNAText="${dataNAText}"/>
                                                                    </c:when>
                                                                    <c:when test="${testToGrades.displayType eq 'oh_performance_index'}">
                                                                        <testDisplay:hgraphOhPerformanceIndex subjectToYears="${subjectToYears}"
                                                                                                              hideSubject="${testToGrades.hideSubject}"
                                                                                                              dataNAText="${dataNAText}"
                                                                                />
                                                                    </c:when>
                                                                    <c:when test="${testToGrades.displayType eq 'hgraph'}">
                                                                        <c:set var="scalesUsed">
                                                                            <div class="smaller fr">Scale: ${testToGrades.scale}</div>
                                                                        </c:set>
                                                                        <testDisplay:hgraph subjectToYears="${subjectToYears}"
                                                                                            hideSubject="${testToGrades.hideSubject}"
                                                                                            dataNAText="${dataNAText}"
                                                                                />
                                                                    </c:when>
                                                                    <c:otherwise>
                                                                        <!-- not showing test data type id ${testToGrades.testDataTypeId} because display type ${testToGrades.displayType} not supported -->
                                                                    </c:otherwise>
                                                                </c:choose>
                                                            </c:forEach>
                                                            <c:out value="${scalesUsed}" escapeXml="false"/>

                                                            <div class="clearfloat"><!-- not empty --></div>
                                                            <h4 class="pbn mbs">About the tests</h4>
                                                            <hr class="keyline1"/>
                                                            <div class="clear mbl"><!-- do not collapse --></div>
                                                            <p class="quiet">${testToGrades.description}</p>
                                                            <c:if test="${testToGrades.isSubgroup and not empty testToGrades.subgroupDescription}">
                                                                <p class="quiet">${testToGrades.subgroupDescription}</p>
                                                            </c:if>
                                                            <c:set var="stateCheck" value="${school.physicalAddress.state}"/>
                                                            <c:choose>
                                                                <c:when test="${(stateCheck eq 'IL') and (testToGrades.isSubgroup eq false )}"><a
                                                                        href="http://www.greatschools.org/content/stateStandards.page?state=${stateCheck}"
                                                                        class="small">See Illinois' state standards</a></c:when>
                                                                <c:when test="${stateCheck eq 'LA'}"><a
                                                                        href="http://www.greatschools.org/content/stateStandards.page?state=${stateCheck}"
                                                                        class="small">See Louisiana's state standards</a></c:when>
                                                            </c:choose>

                                                            <p class="mtl small quiet">
                                                                <strong>Source:</strong> ${testToGrades.source}</p>
                                                        </div>
                                                    </c:if>
                                                </c:forEach>
                                            </c:otherwise>
                                        </c:choose>
                                    </c:forEach>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <mod:deferredTracking key="test-scores" pageName="Test Scores"
                                  hier1="School,SchoolProfileSuite,TestScores"/>
        </c:when>
        <c:otherwise>
            <!-- No data is available -->
            <!-- The message varies by school type which has been placed in the model -->
            <!-- FRONTEND: see file://greatfile/Public/Design/Design_Review/school_profile/index.html sub tab mocks > All versions, no data for styling guidelines -->
            <c:choose>
                <c:when test="${schoolType eq 'private'}">
                    <div class="rnd4 tac mbm noDataBox">
                        <div class="padAmount">
                            <h3><strong>We currently do not have any test score information for this school.</strong>
                                Unlike public schools, private schools are not always required to report data about their schools or not required to take the same tests as public schools. Many private schools take different standardized tests; however, that information is often made available only to families of enrolled students. We strive to acquire additional private school data whenever available.

                            </h3>

                        </div>
                    </div>

                </c:when>
                <c:otherwise>
                    <!-- must be public or charter -->
                    <div class="rnd4 tac mbm noDataBox">
                        <div class="padAmount">
                            <h3>
                                <strong>Oops! We currently do not have any test score information for this school.</strong> Public and charter school test scores for most states come from the state Department of Education.
                                The most common reasons we might not have this data are either that not enough students took the test or that the school was recently opened, and its scores have not yet been reported.

                            </h3>

                        </div>
                    </div>
                </c:otherwise>
            </c:choose>

            <!-- FRONTEND: -->
        </c:otherwise>
    </c:choose>

</jsp:root>