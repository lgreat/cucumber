<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns="http://www.w3.org/1999/xhtml" version="2.0"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:enrollment="urn:jsptagdir:/WEB-INF/tags/school/profile/enrollment"
          xmlns:mod="urn:jsptagdir:/WEB-INF/tags/mod"
        >
    <jsp:directive.page contentType="text/html"/>
    <jsp:output doctype-root-element="html"
                doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN"
                doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>

    <c:set var="ospDataExists" value="${not empty espData ? 'true' : 'false'}"/>

    <c:choose>
        <c:when test="${apply.learnMoreUrl != null and apply.learnMoreUrl != ''}">
            <c:set var="linkFindOutMore">
                <a href="${apply.learnMoreUrl}" target="_blank">Learn more about<br/>enrolling at this school &amp;raquo;</a>
            </c:set>
            <c:set var="linkApplyNow">
                <a href="${apply.learnMoreUrl}" target="_blank" onclick="if (s.tl) {s.tl(this,'o', 'apply_now_button');} return true;">
                    <span class="button-1-big mtm">Apply now</span>
                </a>
            </c:set>
        </c:when>
        <c:otherwise>
            <c:set var="linkFindOutMore" value="To learn more about enrolling, please call the school."/>
            <c:set var="linkApplyNow">
                <!-- do not delete -->
            </c:set>
        </c:otherwise>
    </c:choose>

    <div id="profileProgramsTabs">
        <!-- The page has different layouts depending if there is esp data or not -->
    <div class="alpha grid_16 omega">
        <c:choose>
            <!--
           ==================================== -->
            <!--           ESP DATA AVAILABLE          -->
            <!--
           ==================================== -->
            <c:when test="${not empty espData}">
                <c:choose>
                    <c:when test="${apply.hasApplicationProcess}">
                        <c:choose>
                            <c:when test="${apply.enrollmentState eq 1}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="1" deadlineDate="${apply.deadlineDate}"
                                                                deadlineDaysLeft="${apply.daysLeft}"
                                                                linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}"/>
                                    </div>
                                </div>
                            </c:when>
                            <c:when test="${apply.enrollmentState eq 2}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="2" deadlineDate="${apply.deadlineDate}"
                                                                linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}"/>
                                    </div>
                                </div>
                            </c:when>
                            <c:when test="${apply.enrollmentState eq 3}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="3" linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}" />
                                    </div>
                                </div>
                            </c:when>
                            <c:when test="${apply.enrollmentState eq 4}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="4" linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}" />
                                    </div>
                                </div>
                            </c:when>
                        </c:choose>

                        <div class="line">
                            <div class="unit size32of100">
                                <enrollment:visitSchoolModule school="${school}" />
                                <enrollment:districtBoundaryModule school="${school}" />
                                <enrollment:principalAddContent school="${school}" />
                            </div>
                            <div class="unit size2of100">&amp;nbsp;</div>
                            <div class="unit size66of100 lastUnit">
                                <c:if test="${not empty outsmartingArticle.outsmartingArticleId}">
                                    <enrollment:recommendedReading/>
                                </c:if>
                                <enrollment:enrollmentTilesTableHelper tableTitle="What are your chances?"
                                                              rowList="${chances}" acceptanceHeader="${not empty acceptanceRate}"/>
                                <enrollment:enrollmentTilesTableHelper tableTitle="What does it cost?"
                                                              rowList="${cost}"/>
                                <enrollment:enrollmentTilesTableHelper tableTitle="Planning ahead"
                                                                rowList="${planningAhead}"/>
                            </div>
                        </div>
                    </c:when>
                    <c:otherwise>
                        <div class="line">
                            <div class="unit size32of100">
                                <enrollment:visitSchoolModule school="${school}" />
                            </div>
                            <div class="unit size2of100">&amp;nbsp;<!-- do not collapse --></div>
                            <div class="unit size66of100 lastUnit">
                                <enrollment:applyModule viewType="6" />
                                <c:if test="${not empty outsmartingArticle.outsmartingArticleId}">
                                    <enrollment:recommendedReading/>
                                </c:if>
                                <enrollment:enrollmentTilesTableHelper tableTitle="Planning Ahead"
                                                                rowList="${planningAhead}"/>
                                <div class="line">
                                    <div class="unit size49of100">
                                        <enrollment:districtBoundaryModule school="${school}" />
                                    </div>
                                    <div class="unit size2of100">&amp;nbsp;</div>
                                    <div class="unit size49of100 lastUnit">
                                        <enrollment:principalAddContent school="${school}" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </c:otherwise>
                </c:choose>
            </c:when>
            <c:otherwise>
                <!--
               ==================================== -->
                <!--         NO ESP DATA AVAILABLE         -->
                <!--
               ==================================== -->
                <!-- layout 1 -->
                <div class="line">
                    <div class="unit size32of100">
                        <enrollment:applyModule viewType="5" linkApplyNow="${linkApplyNow}"/>
                        <enrollment:principalAddContent school="${school}" />

                    </div>
                    <div class="unit size2of100">&amp;nbsp;</div>
                    <div class="unit size32of100">
                        <enrollment:visitSchoolModule school="${school}" />
                    </div>
                    <div class="unit size2of100">&amp;nbsp;</div>
                    <div class="unit size32of100 lastUnit">
                        <enrollment:districtBoundaryModule school="${school}" />
                    </div>
                </div>

            </c:otherwise>
        </c:choose>
    </div>
    </div>

    <mod:deferredTracking key="enrollment" pageName="enrollment"/>

</jsp:root>