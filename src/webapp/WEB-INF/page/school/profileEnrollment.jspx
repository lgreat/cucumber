<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns="http://www.w3.org/1999/xhtml" version="2.0"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:school="urn:jsptagdir:/WEB-INF/tags/school"
          xmlns:enrollment="urn:jsptagdir:/WEB-INF/tags/school/profile/enrollment"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:pageHelper="urn:jsptagdir:/WEB-INF/tags/pageHelper"
          xmlns:mod="urn:jsptagdir:/WEB-INF/tags/mod"
          xmlns:gsweb="gstaglib"
        >
    <jsp:directive.page contentType="text/html"/>
    <jsp:output doctype-root-element="html"
                doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN"
                doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>

    <c:set var="ospDataExists" value="${not empty espData ? 'true' : 'false'}"/>

    <c:choose>
        <c:when test="${apply.learnMoreUrl != null and apply.learnMoreUrl != ''}">
            <c:set var="linkFindOutMore" value="&lt;a href='${apply.learnMoreUrl}' target='_blank'&gt;Learn more about enrolling at this school&lt;/a&gt;"/>
            <c:set var="linkApplyNow" value="&lt;a href='${apply.learnMoreUrl}' target='_blank'&gt;&lt;button class='button-1-big mtm' value='Apply now'&gt;Apply now&lt;/button&gt;&lt;/a&gt;"/>
        </c:when>
        <c:otherwise>
            <c:set var="linkFindOutMore" value="To learn more about enrolling, please call the school."/>
            <c:set var="linkApplyNow" value="&lt;!-- do not delete --&gt;"/>
        </c:otherwise>
    </c:choose>

    <div id="profileProgramsTabs">
        <!-- The page has different layouts depending if there is esp data or not -->
    <div class="alpha grid_16 omega">
        <c:choose>
            <!--
           ==================================== -->
            <!--           ESP DATA AVAILABLE          -->
            <!--
           ==================================== -->
            <c:when test="${not empty espData}">
                <c:choose>
                    <c:when test="${apply.hasApplicationProcess}">
                        <c:choose>
                            <c:when test="${apply.enrollmentState eq 1}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="1" deadlineDate="${apply.deadlineDate}"
                                                                deadlineDaysLeft="${apply.daysLeft}"
                                                                linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}"/>
                                    </div>
                                </div>
                            </c:when>
                            <c:when test="${apply.enrollmentState eq 2}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="2" deadlineDate="${apply.deadlineDate}"
                                                                linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}"/>
                                    </div>
                                </div>
                            </c:when>
                            <c:when test="${apply.enrollmentState eq 3}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="3" linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}" />
                                    </div>
                                </div>
                            </c:when>
                            <c:when test="${apply.enrollmentState eq 4}">
                                <div class="line">
                                    <div class="unit size100of100 lastUnit">
                                        <enrollment:applyModule viewType="4" linkFindOutMore="${linkFindOutMore}"
                                                                linkApplyNow="${linkApplyNow}" />
                                    </div>
                                </div>
                            </c:when>
                        </c:choose>
                    </c:when>
                    <c:otherwise>
                        <div class="line">
                            <div class="unit size32of100">
                                waiting on visit module
                                <!--<enrollment:applyModule viewType="5" />-->


                            </div>
                            <div class="unit size2of100">&amp;nbsp;</div>
                            <div class="unit size66of100 lastUnit">
                                <enrollment:applyModule viewType="6" />
                                <!--<enrollment:principalAddContent />-->
                                <div class="line">
                                    <div class="unit size49of100">
                                        <enrollment:districtBoundaryModule school="${school}" />
                                    </div>
                                    <div class="unit size2of100">&amp;nbsp;</div>
                                    <div class="unit size49of100 lastUnit">
                                        <enrollment:principalAddContent school="${school}" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </c:otherwise>
                </c:choose>

                <div class="line">
                    <div class="unit size32of100">
                        waiting on visit module
                        <enrollment:districtBoundaryModule school="${school}" />
                        <enrollment:principalAddContent school="${school}" />
                    </div>
                    <div class="unit size2of100">&amp;nbsp;</div>
                    <div class="unit size66of100 lastUnit">
                        &amp;nbsp;
                    </div>
                </div>
            </c:when>
            <c:otherwise>
                <!--
               ==================================== -->
                <!--         NO ESP DATA AVAILABLE         -->
                <!--
               ==================================== -->
                <!-- layout 1 -->
                <div class="line">
                    <div class="unit size32of100">
                        <enrollment:applyModule viewType="5" linkApplyNow="${linkApplyNow}"/>
                        <enrollment:principalAddContent school="${school}" />

                    </div>
                    <div class="unit size2of100">&amp;nbsp;</div>
                    <div class="unit size32of100">
                        <!-- waiting on visit module -->
                        waiting on visit module
                    </div>
                    <div class="unit size2of100">&amp;nbsp;</div>
                    <div class="unit size32of100 lastUnit">
                        <enrollment:districtBoundaryModule school="${school}" />
                    </div>
                </div>

            </c:otherwise>
        </c:choose>
    </div>
    </div>
</jsp:root>