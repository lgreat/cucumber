<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="1.2"
          xmlns="http://www.w3c.org/1999/xhtml"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:spring="http://www.springframework.org/tags"
          xmlns:search="urn:jsptagdir:/WEB-INF/tags/search"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:gsweb="gstaglib">

<html lang="en">
<jsp:output doctype-root-element="html"
            doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN"
            doctype-system="http://www.w3c.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>

<jsp:directive.page contentType="text/html"/>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"></meta>
    <title>Search</title>

    <link rel="stylesheet" href="res/css/search2.css" type="text/css"
          media="screen"/>

    <style type="text/css">

        .highlight {
            font-weight: 800
        }

        a.s {
            padding-left: 3mm;
            padding-top: 3mm;
        }

        #currentPage {
            font-weight: bold;
            font-size: larger;
        }

        #searchFields {
            border: solid thin gray;
            padding-top: 1mm;
            padding-bottom: 1mm;
            padding-left: 1mm;
            padding-right: 4mm;
            background-color: #EEFFFF;
        }

        .message {
            padding-left: 3mm;
            padding-right: 3mm;
        }

        a.p {
            padding-left: 1mm;
        }

        #suggestion {
            font-style: italic;
            font-weight: bold;
        }

    </style>
</head>

<body onload="document.sf.q.focus()">
    <div style="float: right; padding-right:5mm">
        <a href="mailto:chriskimm@greatschools.net?subject=GS Search">Bugs/Comments</a>
    </div>

    <span style="padding-left:5mm">
            <jsp:scriptlet>
                gs.web.SessionContext context = gs.web.SessionContext.getInstance(session);
                gs.data.state.State state = context.getState();
                out.print("State: ");
                if (state == null) {
                    out.println("none");
                } else {
                    out.println(state.getLongName());
                }
            </jsp:scriptlet>
    </span>

<c:if test="${not empty results.queryTime}">
    <span style="margin-left:1cm">
                    <c:out value="search time: ${results.queryTime} ms"/>
                    </span>
</c:if>

<br/><hr/>
<img src="res/img/header_logo.gif"
     alt="GreatSchools.net"
     border="0"
     height="80"
     width="201"/>

<search:searchControl/>

<!-- begin the result set area -->
<c:if test="${not empty results}">
    <br/>
    <gsml:decorator id="resultoverview">
        <gsweb:searchsummary query="${param.q}"
                             schoolsTotal="${results.schoolsTotal}"
                             constrain="${param.c}"/>
    </gsml:decorator>
<br/>

    <!--
    TODO: FIX - DO NOT REMOVE!!!
    <c:if test="${not empty results.suggestion}">
        Did you mean:
        <span id="suggestion">
                    <a href="/search.page?q=${results.suggestion}&amp;c=${param.c}&amp;s=${param.s}">
                        <c:out value="${results.suggestion}"/>
                    </a>
                </span>
    </c:if>
    <br/>
    -->

    <c:choose>
        <c:when test="${param.c == 'school'}">
            <gsml:decorator id="main">
                <gsweb:schooltable schools="${results.schools}"
                                   query="${param.q}"
                                   sortColumn="${param.sort}"
                                   reverse="${param.r}"
                                   total="${results.schoolsTotal}"
                                   page="${param.p}"/>
            </gsml:decorator>
        </c:when>

        <c:when test="${param.c == 'article'}">
            <gsml:decorator id="main">
                <gsweb:articletable articles="${results.articles}"
                                    query="${param.q}"
                                    sortColumn="${param.sort}"
                                    reverse="${param.r}"
                                    total="${results.articlesTotal}"
                                    page="${param.p}"/>
            </gsml:decorator>
        </c:when>

        <c:when test="${param.c == 'city'}">
            <gsml:decorator id="main">
                <gsweb:citydistricttable results="${results.cities}"
                                         type="city"
                                         query="${param.q}"
                                         sortColumn="${param.sort}"
                                         reverse="${param.r}"
                                         total="${results.citiesTotal}"
                                         page="${param.p}"/>
            </gsml:decorator>
        </c:when>

        <c:when test="${param.c == 'district'}">
            <gsml:decorator id="main">
                <gsweb:citydistricttable results="${results.districts}"
                                         type="district"
                                         query="${param.q}"
                                         sortColumn="${param.sort}"
                                         reverse="${param.r}"
                                         total="${results.districtsTotal}"
                                         page="${param.p}"/>
            </gsml:decorator>
        </c:when>

        <c:when test="${param.c == 'term'}">
            <gsml:decorator id="main">
                <gsweb:termtable results="${results.terms}"
                                 query="${param.q}"
                                 sortColumn="${param.sort}"
                                 reverse="${param.r}"
                                 total="${results.termsTotal}"
                                 page="${param.p}"/>
            </gsml:decorator>
        </c:when>

        <c:otherwise>
            <gsml:decorator id="main">
                <gsweb:mixedresults query="${param.q}" results="${results}"/>
            </gsml:decorator>
        </c:otherwise>
    </c:choose>
</c:if>
<br/>
</body>
</html>
</jsp:root>