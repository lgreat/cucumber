<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns="http://www.w3.org/1999/xhtml" version="2.0"
          xmlns:ad="urn:jsptagdir:/WEB-INF/tags/ad"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:gsweb="gstaglib"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
    >
    <jsp:directive.page contentType="text/html"/>
<html>
<head>
    <title>Test widget - GreatSchools</title>
    <ad:setSlotPrefix slotPrefix="Community"/>
    <link type="text/css" rel="stylesheet" href="/res/css/widget/editorialWidget.css"/>

    <c:set var="cobrandSite" value="${requestScope.context.cobrand}"/>
    <c:if test="${cobrandSite eq null or cobrandSite eq ''}">
        <c:set var="cobrandSite" value="www"/>
    </c:if>
    <c:set var="worksheet" value="od7"/>
    <c:set var="feature" value="feature01"/>
    <c:set var="state" value="${param.defaultState}"/>

    <script type="text/javascript" charset="utf-8">
        function textSwitch(el, target, replace) {
            if (el.value == replace) {
                el.value = target;
            }
        }

        function checkForm(form) {
            if (form['state'].value == '') {
                alert("Please select a state.");
                return false;
            }
            return true;
        }
    </script>
    <gsml:url var="gspreadsheetJs" value="/res/js/gspreadsheet/gspreadsheet.js"/>
    <![CDATA[<script type="text/javascript" src="${gspreadsheetJs}"></script>]]>
    <script type="text/javascript">
        window.onload = function() {
            GSpreadsheet.load("pouqRkV5D_eZo2j7CmCj0OQ", { index: 'key', worksheet: '${worksheet}' }, function(gs) {
                var row = gs.select("${feature}");
                row.link = row.link.replace("$STATE", "${state}");
                document.getElementById("featuredArticleTitle").innerHTML = row.title;
                document.getElementById("featuredArticleTitle").setAttribute("href", row.link);
                document.getElementById("featuredArticleContent").innerHTML = row.html;
                document.getElementById("featuredArticleLink").setAttribute("href", row.link);
                document.getElementById("featuredArticleLink").innerHTML = row.linktext;
            });
        }
    </script>
    <base target="_blank"/>    
</head>
<body>
    <div class="wrapper">
        <div class="title">School Information ${requestScope.context.cobrand}</div>

        <div class="body">
            <div class="logo">
                <a href="/"
                   target="_blank"><img border="0"
                                        width="130"
                                        height="20"
                                        src="/res/img/logo/logo_GS_130x20.gif"
                                        alt="GreatSchools"/></a>
            </div>
            <form method="GET" target="_blank"
                  action="/search/search.page"
                  onsubmit="return checkForm(this);">
                <div class="featureText">
                    Find information about<br/>
                    schools in your area.
                </div>
                <div class="searchContent">
                    <input type="text" maxlength="75" name="q"
                           value="Search for school, district or city"
                           class="searchInput"
                           onfocus="textSwitch(this, '', 'Search for school, district or city');"
                           onblur="textSwitch(this, 'Search for school, district or city', '');"/>

                    <gsweb:stateSelector styleClass="searchDropdown" name="state"
                                         useNoState="${state eq null or state eq ''}"
                                         noStateLabel="--" state="${state}"/>
                    <input type="submit" value="Search" class="searchSubmit"/>
                </div>
            </form>
            <form method="GET" target="_blank"
                  action="/search/search.page"
                  onsubmit="return checkForm(this);">
                <div class="featureText">
                    Find test scores in your state.
                </div>
                <div class="searchTestScores">
                    <gsweb:stateSelector styleClass="searchDropdown" name="state"
                                         useNoState="${state eq null or state eq ''}"
                                         noStateLabel="--" state="${state}"/>
                    <input type="submit" value="Find test scores" class="testScoresSubmit"/>
                </div>
            </form>
            <div class="text">
                Search for parent reviews, ratings and more on
                over 80,000 preschools and 130,000 K-12 schools
                nationwide.
            </div>
            <div class="articleFeature">
                <div class="featureText">Featured Article</div>
                <![CDATA[
                    <h4><a href="#" id="featuredArticleTitle"></a></h4>
                    <div id="featuredArticleContent"></div>
                    <a href="#" id="featuredArticleLink"></a>
                ]]>
            </div>

        </div>

    </div>
</body>
</html>
</jsp:root>