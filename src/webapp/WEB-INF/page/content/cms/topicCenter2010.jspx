<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns="http://www.w3.org/1999/xhtml"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:content="urn:jsptagdir:/WEB-INF/tags/content"
          xmlns:pageHelper="urn:jsptagdir:/WEB-INF/tags/pageHelper"
          xmlns:school="urn:jsptagdir:/WEB-INF/tags/school"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:cms="urn:jsptagdir:/WEB-INF/tags/content/cms"
          xmlns:promo="urn:jsptagdir:/WEB-INF/tags/promo"
          xmlns:gsweb="gstaglib"
          xmlns:ad="urn:jsptagdir:/WEB-INF/tags/ad"
          xmlns:link="urn:www.greatschools.org/taglib/link"
          xmlns:mod="urn:jsptagdir:/WEB-INF/tags/mod"
          xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          version="2.0">
<html lang="en">
<jsp:directive.page contentType="text/html"/>
<c:if test="${topicCenter.contentKey.identifier eq 1633}">
    <pageHelper:setPathway pathway="TOP_NAV_PROMO"/>
</c:if>
<c:set var="pageName" value="${omnitureTopicCenterName} Landing Page" scope="request"/>

<head>
    <c:choose>
        <c:when test="${not empty topicCenter.pageTitle}">
            <c:set var="pageTitle">${topicCenter.pageTitle}</c:set>
        </c:when>
        <c:otherwise>
            <c:set var="pageTitle">${topicCenter.title}</c:set>
        </c:otherwise>
    </c:choose>
    <title>${pageTitle} | GreatSchools</title>
    <meta name="description" content="${topicCenter.metaDescription}"/>
    <meta name="keywords" content="${topicCenter.metaKeywords}"/>
    <!-- pageHelper:externalJavascript file="/res/js/jquery/plugins/curvycorners/2.0.3/curvycorners.js"/ -->
    <pageHelper:externalJavascript file="/res/js/topiccenter/topicCenter2010.js"/>
    <!--<pageHelper:externalCss file="/res/css/widelayout.css"/>-->
    <!--<pageHelper:externalCss file="/res/css/content/cmsTopicCenter.css"/>-->
    <!--<pageHelper:externalCss file="/res/css/content/db_tc_hover.css"/>-->
    <!--<pageHelper:externalCss file="/res/css/_textStyles.css"/>-->
    <!--<pageHelper:externalCss file="/res/css/discussionBoards/db_community.css"/>-->

    <c:choose>
        <c:when test="${topicCenter.healthAndDevelopmentTopicCenter}">
            <pageHelper:setPathway pathway="HEALTH_AND_DEVELOPMENT"/>
        </c:when>
        <c:when test="${topicCenter.academicsAndActivitiesTopicCenter}">
            <pageHelper:setPathway pathway="ACADEMICS_AND_ACTIVITIES"/>
        </c:when>
        <c:when test="${topicCenter.learningDisabilitiesTopicCenter}">
            <pageHelper:setPathway pathway="LEARNING_DISABILITIES"/>
        </c:when>
        <c:when test="${topicCenter.contentKey.identifier eq 1542}">
            <pageHelper:setPathway pathway="PREP_FOR_COLLEGE"/>
        </c:when>
        <c:when test="${topicCenter.contentKey.identifier eq 1543}">
            <pageHelper:setPathway pathway="IMPROVE_YOUR_SCHOOL"/>
        </c:when>
    </c:choose>

    <ad:setSlotPrefix slotPrefix="Library_Article_Page"/>
</head>

<gsml:body adPageName="${pageName}">


    <div id="mainGS" class="col">
        <div id="featured" class="fltlft">
            <div class="spacer_10"><!--do not collapse--></div>
            <h1 class="fltlft">${topicCenter.title}</h1>

            <!-- DONE-9457, DONE-9536 Randall, this ad slot will only show up on some topic centers, currently only Health & Development, content=1539 -->
            <div class="logoAd fltrt mrgtop_5">
                <ad:adTag position="HeaderLogo_88x33"/>
            </div>
            <div class="spacer_5"><!--do not collapse--></div>

            <c:set var="showFeatureGroups" value="false"/>
            <c:if test="${not empty topicCenter.featureGroups}">
                <c:forEach var="featureGroup" items="${topicCenter.featureGroups}">
                    <c:if test="${not empty featureGroup.mainFeatureLink and not empty featureGroup.otherFeatureLinks}">
                        <c:set var="showFeatureGroups" value="true"/>
                    </c:if>
                </c:forEach>
            </c:if>

            <!-- Features -->
            <c:choose>
                <c:when test="${showFeatureGroups}">
                    <c:forEach var="featureGroup" items="${topicCenter.featureGroups}">
                        <div>${featureGroup.title}</div>
                        <cms:topicCenterFeature imageUrl="${featureGroup.imageUrl}"
                                                imageAltText="${featureGroup.imageAltText}"
                                                mainFeatureLink="${featureGroup.mainFeatureLink}"
                                                otherFeatureLinks="${featureGroup.otherFeatureLinks}"/>
                    </c:forEach>
                </c:when>
                <c:otherwise>
                    <cms:topicCenterFeature imageUrl="${topicCenter.imageUrl}"
                                            imageAltText="${topicCenter.imageAltText}"
                                            mainFeatureLink="${topicCenter.mainFeatureLink}"
                                            otherFeatureLinks="${topicCenter.otherFeatureLinks}"/>
                </c:otherwise>
            </c:choose>

        </div>
        <!-- end #featured -->
        <div class="clearfloat"><!-- don't collapse --></div>
        <!-- Subtopics -->
        <div id="topicContentGS">

            <div id="topicbarGS" class="col">

                <c:set var="moreOnThisTopic">
                    <cms:browseSidebar title="More on this topic" subtopics="${requestScope.topicCenter.subtopics}"/>
                </c:set>

                <c:set var="browseByGrade">
                    <c:if test="${topicCenter.elementarySchoolTopicCenter or
                                  topicCenter.academicsAndActivitiesTopicCenter or
                                  topicCenter.healthAndDevelopmentTopicCenter or
                                  topicCenter.learningDisabilitiesTopicCenter}">
                        <cms:browseSidebar title="Browse by grade" subtopics="${requestScope.browseByGradeSubtopics}"/>
                    </c:if>
                </c:set>

                <c:choose>
                    <c:when test="${topicCenter.elementarySchoolTopicCenter}">
                        ${browseByGrade}
                        ${moreOnThisTopic}
                    </c:when>
                    <c:when test="${topicCenter.academicsAndActivitiesTopicCenter or
                                    topicCenter.healthAndDevelopmentTopicCenter or
                                    topicCenter.learningDisabilitiesTopicCenter}">
                        ${moreOnThisTopic}
                        ${browseByGrade}
                    </c:when>
                    <c:otherwise>
                        ${moreOnThisTopic}
                    </c:otherwise>
                </c:choose>

                <!-- TODO-9457, TODO-9536 Randall, this ad slot should appear below the browse sidebar -->
                <div class="skyscraperAd">
                    <ad:AboveFold_Left_160x600/>
                </div>
                <br />

            </div>
            <!-- end #topicbarGS -->

            <div id="topicMainGS" class="col">

            <!-- DONE-9457, DONE-9536 Randall, this ad slot will only show up on some topic centers, currently only Health & Development, content=1539 -->
            <div class="inlineAd">
                <ad:adTag position="Inline_423x60"/>
            </div>

            <c:if test="${topicCenter.healthAndDevelopmentTopicCenter}">
            <div class="spacer_15"><!-- do not collapse --></div>
            </c:if>

            <cms:infiniteCarousel name="${requestScope.topicCenter.carouselName}" items="${requestScope.carouselItems}"/>

            <c:set var="raiseYourHand">
                <c:import
                        url="/community/raiseYourHand.module?featureContentKey=${gsweb:urlEncode(topicCenter.contentKey)}&amp;limit=3&amp;style=topicCenter&amp;showViewAll=true"/>
            </c:set>
            ${raiseYourHand}

                <!-- Community links -->
                <gsweb:currentAbsolutePath var="myUrl" urlEncode="true"/>
                <c:set var="recentDiscussions">
                    <c:import
                            url="/community/recentDiscussions.module?board_id=${requestScope.topicCenter.discussionBoardId}&amp;limit=5"/>
                    <!--&amp;uri=${myUrl}&amp;style=fall2009-->
                </c:set>
                <c:if test="${!empty recentDiscussions}">
                    <div class="spacer_10"><!-- don't collapse --></div>
                    <div id="recentDiscussions" class="mod">
                        ${recentDiscussions}
                    </div>
                </c:if>
            </div>
            <!-- end #topicMainGS -->

        </div>
        <!-- end #topicContentGS -->

        <div class="clear"><!-- don't collapse --></div>

    </div>
    <!-- end #mainGS -->

    <div id="sidebarGS" class="col">

        <c:if test="${topicCenter.gradeLevelTopicCenter}">

            <c:choose>
                <c:when test="${topicCenter.preschoolTopicCenter}">
                    <c:set var="levelCode" value="p"/>
                    <c:set var="levelCodeName" value="preschool"/>
                </c:when>
                <c:when test="${topicCenter.elementarySchoolTopicCenter}">
                    <c:set var="levelCode" value="e"/>
                    <c:set var="levelCodeName" value="elementary"/>
                </c:when>
                <c:when test="${topicCenter.middleSchoolTopicCenter}">
                    <c:set var="levelCode" value="m"/>
                    <c:set var="levelCodeName" value="middle"/>
                </c:when>
                <c:when test="${topicCenter.highSchoolTopicCenter}">
                    <c:set var="levelCode" value="h"/>
                    <c:set var="levelCodeName" value="high"/>
                </c:when>
            </c:choose>
            <school:findASchool city="${requestScope.cityObject}"
                                topRatedSchools="${requestScope.topRatedSchools}"
                                topSchools="${requestScope.topSchools}"
                                levelCode="${levelCode}" levelCodeName="${levelCodeName}"/>
        </c:if>

        <c:if test="${topicCenter.contentKey.identifier eq 2220}">
            <promo:searchRealtorDotCom omniturePageName="${pageName}" pageAdRatioKey="RDC_PCT_TOPIC_CENTER" showAdPct="0"/>
        </c:if>

        <div id="seasonalPromo">
            <c:choose>
                <c:when test="${requestScope.context.cobranded}">
                    <link:schoolChoiceCenter styleClass="more"><gsml:img
                            src="/res/img/content/schoolChoiceTips/schoolChoiceTips_300x137.jpg"
                            alt="School Choice Tips"/></link:schoolChoiceCenter>
                </c:when>
                <c:otherwise>
                    <gsweb:adTagGenerator position="House_Ad_300x137"/>
                </c:otherwise>
            </c:choose>
        </div>
        <!-- end #seasonalPromo -->

        <div id="squareadvert">
            <ad:AboveFold_300x250/>
        </div>
        <!-- end #squareadvert -->

        <jsp:include page="/content/cms/mostPopularContent.module?style=reskin2010"/>

        <!-- DONE-9457 RANDALL, please make this tag pretty! it only shows up on grade-level topic centers -->
        <c:if test="${topicCenter.gradeLevelTopicCenter}">
            <school:browseSchoolsInCity gradeLevel="${topicCenter.gradeLevel}"/>
        </c:if>

    </div>
    <!-- end #sidebarGS -->


    <mod:almondNet title="${pageTitle}" category="${almondNetCategory}"/>

    <mod:tracking pageName="${pageName}"
                  hier1="Topic Centers,${omnitureTopicCenterName}"
                  omitAlmondNet="${true}"
            />

</gsml:body>
</html>
</jsp:root>