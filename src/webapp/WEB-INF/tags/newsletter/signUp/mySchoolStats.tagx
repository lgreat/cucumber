<?xml version="1.0" encoding="UTF-8"?>
<jsp:root
        version="2.0"
        xmlns:jsp="http://java.sun.com/JSP/Page"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:c="http://java.sun.com/jsp/jstl/core"
        xmlns:fn="http://java.sun.com/jsp/jstl/functions"
        xmlns:form="http://www.springframework.org/tags/form"
        xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
        xmlns:gsweb="gstaglib"
        >

    <fieldset>

                <div class="newsletterInfo">
                    <h5 class="newsletterHeader bottom pls">My School Stats</h5>
                        <p class="smaller quite bottom pls pts">MONTHLY</p>
                        <h6 class="newsletterDescription medium bottom pls pts">
                            Track your child's school stats &amp;#8212; from test scores to teacher quality.
                            (Available for public schools only)
                        </h6>
                    </div>
                    <div class="spacer_10"><!-- do not collapse --></div>
                    <div class="mssInfo">
                        <h6 class="${newslettersSignUpCommand.school1 ? '' : 'hidden'} medium pls"
                           id="jq-mssHeading">Subscribe to school updates on:</h6>
                        <input type="hidden" id="jq-numMssSchools"
                               name="numMssSchools" value="${fn:length(newslettersSignUpCommand.myStatIds)}"/>
                        <div id="jq-mssSchoolLineTemplate" class="mssSchoolLine hidden">
                            <input type="checkbox" id="jq-mssSchoolX" class="newsletterCheckbox pls"
                                   checked="checked"/>
                            <label for="jq-mssSchoolX" class="medium addedSchool">REPLACE-ME</label>
                            <input type="hidden" name="uniqueStateId" value="REPLACE-ME"/>
                        </div>
                        <div id="jq-mssSchoolSection">
                            <c:if test="${newslettersSignUpCommand.school1}">
                                <c:forEach var="school" items="${newslettersSignUpCommand.currentMySchoolStats}"
                                           varStatus="schoolCounter">
                                    <div class="mssSchoolLine">
                                        <form:checkbox path="school${schoolCounter.count}"
                                                       id="jq-mssSchool${schoolCounter.count}"
                                                       cssClass="newsletterCheckbox"/>
                                        <label for="jq-mssSchool${schoolCounter.count}">${school.name}, ${school.city}, ${school.stateAbbreviation}</label>
                                        <input type="hidden" name="id${schoolCounter.count}"
                                               value="${newslettersSignUpCommand.myStatIds[schoolCounter.count -1]}"/>
                                        <input type="hidden" name="name${schoolCounter.count}"
                                               value="${school.name}"/>
                                        <input type="hidden" name="uniqueStateId"
                                               value="${school.stateAbbreviation}${school.id}"/>
                                    </div>
                                </c:forEach>
                            </c:if>
                        </div>
                        <c:set var="addSectionDisplayStyle" value="block"/>
                        <c:if test="${fn:length(newslettersSignUpCommand.myStatIds) ge 4}">
                            <c:set var="addSectionDisplayStyle" value="none"/>
                        </c:if>
                        <div class="spacer_10"><!-- do not collapse --></div>
                        <div id="jq-mssAddSchoolSection" style="display:${addSectionDisplayStyle};">
                            <h6 class="medium_bold bottom pls">Add a school<span class="text3"> (four maximum)</span></h6>
                            <ul>
                                <li class="pls">
                                <gsweb:stateSelector state="${newslettersSignUpCommand.stateAdd}" styleId="jq-stateAdd"
                                                     name="stateAdd"
                                                     noStateLabel="1. Choose state"
                                                     allowNoState="true"
                                        />
                            </li>
                            <li id="city" class="pls">
                                <select id="jq-citySelect" name="city">
                                    <c:if test="${newslettersSignUpCommand.cityList ne null}">
                                        <option selected="selected" value="">2. Choose city</option>
                                    </c:if>
                                    <c:forEach var="cityOption" items="${newslettersSignUpCommand.cityList}">
                                        <![CDATA[<option ]]>
                                        <c:if test="${newslettersSignUpCommand.city eq cityOption.name}">
                                            selected="selected"
                                        </c:if>
                                        <![CDATA[ value="${cityOption.name}">${cityOption.name}</option>]]>
                                    </c:forEach>
                                </select>
                            </li>
                            <gsml:feedbackMessage command="newslettersSignUpCommand" field="city"
                                                  styleClass="ajaxMessage ajaxError"/>
                            <li id="schoolsInCity" class="pls">
                                <select name="school" id="jq-school" class="selectChildSchool">
                                    <option selected="selected" value="0">3. Choose school</option>
                                    <c:forEach var="schoolOption" items="${newslettersSignUpCommand.currentMySchoolStats}">
                                        <![CDATA[<option ]]>
                                        <![CDATA[ value="${schoolOption.id}">${schoolOption.name}</option>]]>
                                    </c:forEach>
                                </select>
                            </li>
                        </ul>
                        <div class="spacer_10"><!-- do not collapse --></div>
                        <div class="pls">
                            <button class="button-1 fltlft" type="button" id="jq-addMssSchool" name="Add"
                                    value="Add">Add
                            </button>
                        </div>
                        <div class="spacer_15"><!-- do not collapse --></div>
                    </div>
                    <!-- end #jq-mssAddSchoolSection -->
                </div>
                <!-- end .mssInfo -->

    </fieldset>

</jsp:root>