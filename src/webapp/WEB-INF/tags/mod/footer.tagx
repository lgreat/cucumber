<?xml version="1.0" encoding="UTF-8"?>
<jsp:root version="2.0"
          xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
          xmlns:ad="urn:jsptagdir:/WEB-INF/tags/ad"
          xmlns:link="urn:www.greatschools.org/taglib/link"
          xmlns:promo="urn:jsptagdir:/WEB-INF/tags/promo"
          xmlns:gsweb="gstaglib"
        >
    <jsp:directive.tag import="gs.web.util.PageHelper"/>
    <jsp:directive.tag import="gs.web.util.context.SessionContext"/>
    <jsp:directive.tag import="gs.web.util.context.SessionContextUtil"/>
    <jsp:directive.tag body-content="empty" description="Common GS footer tag"/>
    <jsp:directive.attribute name="showAd" required="false" type="java.lang.Boolean"
                             description="Show the ad in the footer or not."/>
    <jsp:directive.attribute name="showSeoFooter" required="false" type="java.lang.Boolean"
                             description="Show the SEO links in the footer or not."/>
    <jsp:directive.attribute name="showOnlyCopyrightFooter" required="false" type="java.lang.Boolean"
                             description="Show only the copyright footer."/>

    <jsp:scriptlet>
        request.setAttribute("tabs", PageHelper.pageIds);
    </jsp:scriptlet>

    <jsp:scriptlet>
        SessionContext sessionContext = SessionContextUtil.getSessionContext(request);
        request.setAttribute("communityHost", sessionContext.getSessionContextUtil().getCommunityHost(request));
        java.text.SimpleDateFormat formatNowYear = new java.text.SimpleDateFormat("yyyy");
        request.setAttribute("currentYear", formatNowYear.format(java.util.Calendar.getInstance().getTime()));
    </jsp:scriptlet>

    <c:if test="${requestScope.pageHelper.showingFooter}">

        <!--GS-12019 Backup and restore "s" js variable since MyAllergySurvey ad is overwriting s and breaking future JS code
        remove if ad compaign is over or when tracking.tagx is moved below this point-->
        <script type="text/javascript">
            s_backup = s;
        </script>

        <c:choose>
            <c:when test="${pageContext.request.requestURI eq '/index.page'}">
                <div id="homepageFooterAd">
                    <div class="container_24">
                        <ad:Homepage_Footer_728x90/>
                    </div>
                </div>
            </c:when>
            <c:when test="${showAd}">
                <!--<div id="footerAd">-->
                <div class="container_24">
                    <div class="prefix_3 grid_19 suffix_2">
                        <ad:footerAd/>
                    </div>
                </div>
                <div class="clear mbl"><!-- do not collapse --></div>
            </c:when>
            <c:otherwise>
                <!--do not show a footer ad-->
            </c:otherwise>
        </c:choose>

        <!--GS-12019-->
        <script type="text/javascript">
            s = s_backup;
        </script>

        <!--<div id="connectWithUs">-->
            <!--<div class="connectContent">-->
                <!--<p class="medium subtitles bottom pbm">Sign up for email updates</p>-->
            <!--</div>-->
        <!--</div>-->

        <div id="footer" class="slStylesV1-0 ${(showOnlyCopyrightFooter or requestScope.context.customCobrandedFooter)?'custom':''}">
            <promo:footerConnectWithUs userIsAlreadySignedUp="false" />

            <div id="footnav" class="clearfix">
                <div class="navAbout">
                    <p class="small_bold subtitles bottom pbm">About GreatSchools</p>
                    <p class="small make-999999 bottom prl">Our mission is to inspire and support families to champion their children's education - at school, at home, and in their community. We are a national non-profit with offices in San Francisco, Milwaukee, Washington D.C. and Indianapolis.</p>
                </div>
                <div class="navFoot">
                    <!--<p class="medium subtitles bottom pbm">Company</p>-->
                    <ul class="none">
                        <li><gsml:a href="/about/aboutUs.page">Our mission</gsml:a></li>
                        <li><gsml:a href="/about/senior-management.page">Our people</gsml:a></li>
                        <li><gsml:a href="/jobs/">Jobs</gsml:a></li>
                        <li><link:contactUs>Contact us</link:contactUs></li>
                    </ul>
                </div>
                <div class="navFoot">
                    <!--<p class="medium subtitles bottom pbm">Media</p>-->
                    <ul class="none">
                        <li><gsml:a href="/about/advertiserOpportunities.page">Advertise with us</gsml:a></li>
                        <li><gsml:a href="/about/partnerOpportunities.page">Partners</gsml:a></li>
                        <li><link:pressRoom>Media room</link:pressRoom></li>
                        <li><gsml:a href="/about/linkToUs.page">Widgets &amp;#38; tools</gsml:a></li>
                    </ul>
                </div>
                <div class="navFootLast">
                    <!--<p class="medium subtitles bottom pbm">Policies</p>-->
                    <ul class="none">
                        <li><gsml:a href="/find-a-school/defining-your-ideal/2423-ratings.gs">How we rate schools</gsml:a></li>
                        <li><link:parentReviewGuidelines>School review guidelines</link:parentReviewGuidelines></li>
                        <li><link:termsOfUse>Terms of use</link:termsOfUse></li>
                        <li><link:privacyPolicy>Privacy policy</link:privacyPolicy></li>
                    </ul>
                </div>
            </div>

            <c:set var="hidePopularCitiesModule"
                   value="${(showOnlyCopyrightFooter or requestScope.context.customCobrandedFooter)}"/>
            <hr class="keyline3 mtl" />
            <div id="navFooter"
                 class="cities popularCities ${hidePopularCitiesModule? 'dn':'' }">
                <c:set var="popularCitiesKey" value="/geo/popularCities.module?state=${stateForPopularCities}"/>
                <gsweb:cache key="${popularCitiesKey}" cacheName="gs.web.cache.fragment.geo.PopularCities">
                    <jsp:include page="${popularCitiesKey}"/>
                </gsweb:cache>
            </div>
            <hr class="keyline3" />
            <div class="ptm pbs">
                <p class="copyright smaller bottom">GreatSchools, Inc. 160 Spear Street, Suite 1020, San Francisco, CA 94105</p>
                <p class="copyright smaller bottom">
                    &amp;#169;1998-${currentYear} GreatSchools Inc. All Rights Reserved.
                    GreatSchools is a 501(c)(3) not-for-profit organization
                </p>
            </div>
        </div>
    </c:if>
</jsp:root>
