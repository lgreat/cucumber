<?xml version="1.0" encoding="UTF-8"?>
<jsp:root version="2.0"
          xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:fn="http://java.sun.com/jsp/jstl/functions"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
        >
    <jsp:directive.tag body-content="empty"/>
    <!--
    This tag determines when to display the popunder and if it's a go sets to request
    variables (onloadPopunder and triggerPopunder) that can be used to populate the
    onload function or as part of an onsubmit on a form to get around popup blockers.

    On the main website we show 2 popunders, on cobrands we only display 1 popunder
    The ad_popunder.js code determines if we should display 1 or 2
    On yahoo, framed, number1expert, mcguire we show none
    -->
    <c:set var="state" value="${fn:toLowerCase(requestScope.context.stateOrDefault.abbreviation)}"/>
    <c:if test="${!requestScope.pageHelper.adFree and !requestScope.context.yahooCobrand}">
        <c:set var="onloadPopunder" scope="request" value="DisplayPopunder('${state}','x06|x17');"/>
        <c:set var="triggerPopunder" scope="request" value="DisplayPopunderSpecial('${state}','x06|x17'); return true;"/>
        <gsml:url var="popunderJs" value="/cm/ad_popunder.js" />
        <![CDATA[<script language="javascript" type="text/javascript" src="${popunderJs}"></script>]]>
    </c:if>
</jsp:root>
