<?xml version="1.0" encoding="UTF-8"?>
<jsp:root version="2.0"
          xmlns:jsp="http://java.sun.com/JSP/Page"
        >
    <jsp:directive.tag import="gs.web.util.PageHelper"/>
    <jsp:directive.tag import="gs.web.ads.AdPosition"/>
    <jsp:directive.tag body-content="empty"
                       description="Enables GPT synchronous mode on the calling page" />

    <!--
    This tag must be called before the AdTagHandler call gets made, or else it will have no effect.
    Ads called via the standard decorator will have AdTagHandler called after the .jspx that uses that decorator,
    so as long as this tag is called for e.g. the header and footer ads on the relevant .jspx, disabling GPT ghost text
    will work properly.
    -->

    <jsp:directive.attribute name="position" required="true" description="Ad slot position" type="java.lang.String" />
    <jsp:scriptlet>
    <![CDATA[
        AdPosition adPosition = AdPosition.getAdPosition(position);
        PageHelper pageHelper = (PageHelper) request.getAttribute(PageHelper.REQUEST_ATTRIBUTE_NAME);
        if (pageHelper != null && adPosition != null) {
            pageHelper.addAdPositionWithDisabledGptGhostTextHiding(adPosition);
        }
    ]]>
    </jsp:scriptlet>
</jsp:root>