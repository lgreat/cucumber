<?xml version="1.0" encoding="UTF-8"?>
<jsp:root version="2.0"
          xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:gsml="urn:jsptagdir:/WEB-INF/tags/gsml"
        >
    <jsp:directive.tag import="java.net.URLEncoder"/>
    <jsp:directive.tag import="gs.web.util.UrlUtil"/>
    <jsp:directive.tag body-content="empty"
                       description="Used to add a meta tag to the document head. The meta tag will contain property and content attributes."/>
    <jsp:directive.attribute name="url" required="true" type="java.lang.String" description="Full url for this page"/>
    <jsp:directive.attribute name="deck" required="true" type="java.lang.String"
                             description="summary for the cms feature"/>
    <jsp:directive.attribute name="title" required="true" type="java.lang.String"
                             description="title for the cms feature"/>
    <jsp:directive.attribute name="imageUrl" required="false" type="java.lang.String"
                             description="image url of the article"/>

    <jsp:scriptlet>

        String encodedUrl = null;
        String baseUrl = null;
        if (UrlUtil.isDeveloperWorkstation(request.getServerName())) {
            baseUrl = "http://www.greatschools.org";
        } else {
            baseUrl = request.getScheme() + "://" + request.getServerName() + ":" + request.getServerPort();
        }
        if ((url != null) &amp;&amp; (baseUrl != null)) {
            String justUrl = url.substring(0, url.indexOf("?"));
            encodedUrl = URLEncoder.encode(baseUrl + justUrl + "?page=1", "UTF-8");
            request.setAttribute("pageUrlOnFacebook", encodedUrl);
        }

        gs.web.util.PageHelper.addMetaProperty(request, "og:type", "article");
        gs.web.util.PageHelper.addMetaProperty(request, "og:site_name", "GreatSchools");
        gs.web.util.PageHelper.addMetaProperty(request, "fb:app_id", "112862918759431");
        gs.web.util.PageHelper.addMetaProperty(request, "og:image", "http://www.greatschools.org/res/img/content/article/GS_FB_logo_200x200.jpg");
        gs.web.util.PageHelper.addMetaProperty(request, "og:description", deck);
        gs.web.util.PageHelper.addMetaProperty(request, "og:url", encodedUrl);
        gs.web.util.PageHelper.addMetaProperty(request, "og:title", title);
        if (imageUrl != null) {
            gs.web.util.PageHelper.addMetaProperty(request, "og:image", imageUrl);
        }

    </jsp:scriptlet>
</jsp:root>