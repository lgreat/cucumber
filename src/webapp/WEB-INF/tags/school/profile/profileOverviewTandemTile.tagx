<?xml version="1.0" encoding="UTF-8"?>
<jsp:root version="2.0"
          xmlns:jsp="http://java.sun.com/JSP/Page"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:ad="urn:jsptagdir:/WEB-INF/tags/ad"
          xmlns:gslink="urn:jsptagdir:/WEB-INF/tags/link"

        >
    <jsp:directive.attribute name="microsoftBranding" type="java.lang.Boolean" required="false"/>
    <jsp:directive.attribute name="ospDataExistsLocal" type="java.lang.Boolean" required="true"/>

    <!--<c:set var="microsoftBranding" value="true"/>-->
    <script type="text/javascript">
        var ncesCode = '${school.ncesCode}';
        var hasOspData = '${ospDataExistsLocal}';
        var hasCalendarData = null;
        var hasTandemBranding = '${microsoftBranding}';
//        console.log("hasTandemBranding",hasTandemBranding);
        $(function() {

            GS.school.calendar.getEventsAndUpdateListUI(ncesCode).done(function(events) {
                // TODO: check events to see if there was any data
                hasCalendarData = true;
                if (hasCalendarData) {
                    if (hasOspData == 'true') {
                        // hide a tile
                        $('#js-tile-10-0, #js-tile-10-1, #js-tile-10-2').hide();

                    } else {
                        // hide a different tile
                        // TODO: I think we have to give the other tiles in profileOverviewLocalInfoTile IDs, and hide
                        // here as well
                        $('#js-tile-13-1').hide();
                        $('#js-tile-tandem').next('.mod.standard_1-1').hide(); // only way I could find to select the tile I need to hide
                    }
                    $('#js-tile-tandem, #js-school-calendar-list').show();

                    GS.tracking.data['overview'].props['prop56'] = 'cal';
                    GS.tracking.addTabSpecificProps('overview', 'prop56');
                    GS.tracking.sendAndRestore({'prop56' : 'cal'});
                }
            }).fail(function() {
                        // don't show tile
                        hasCalendarData = false;
                        // depends on the tile in profileOverviewProgramsTile that is displayed
                        var tileName = '';
                        if (jQuery('#js-tile-10-0').is(':visible')) {
                            tileName = 'prog'
                        }
                        else if (jQuery('#js-tile-10-1').is(':visible')) {
                            tileName = 'parent'
                        }
                        else if (jQuery('#js-tile-10-2').is(':visible')) {
                            tileName = 'hilite'
                        }
                        GS.tracking.data['overview'].props['prop56'] = tileName;
                        GS.tracking.addTabSpecificProps('overview', 'prop56');
                        GS.tracking.sendAndRestore({'prop56' : tileName});
                    });
//            setTimeout(GS.school.calendar.getEventsAndUpdateListUI('181281002036'), 3000);
        });

    </script>




    <c:set var="moduleTitleTandem">
        <p class="small_bold textshadow-1 pbm bottom make-555555 ptl" >Important Upcoming Dates</p>
    </c:set>
    <div id="js-tile-tandem" class="dn">
        <gslink:linkToTab tabName="culture" anchor="js-school-calendar-list-anchor" customLink="overview_culture_calendar" cssClass="tdn make-555555 js-trigger"
                tileName="cal">
            <div class="mod standard_7-1">
                <div class="inner box-shadow-animation-1 tac">
                    <!--${moduleTitleTandem}-->
                    <c:set var="msBrandingBox" value="bd" />
                    <c:if test="${microsoftBranding == 'true'}">
                        <c:set var="msBrandingBox" value="bd-MS-brandedskin" />
                    </c:if>
                    <div class="${msBrandingBox} clearfix mha">
                        <p class="make-ffffff" style="padding-top:8px; font-family: SourceSansPro-Bold; font-size: 18px;" id="js-tandemOverviewTileMonth"><!-- do not collapse --></p>
                        <p class="pts bottom" style="font-family: SourceSansPro-Bold; font-size: 47px;" id="js-tandemOverviewTileDay"><!-- do not collapse --></p>
                        <p class="ptm small ptm bottom phs" id="js-tandemOverviewTileEvent"><!-- do not collapse --></p>
                    </div>
                    <c:if test="${microsoftBranding == 'true'}">
                        <div class="ft small pvs pls" style="margin: 0 auto;">
                            <div style="width:150px" class="pll">
                            <ad:Branded_Tandem_Tile_150x30 />
                            <!--<div class="fl tac plm smallest bottom make-999999" style="line-height: 12px">BROUGHT<br />TO YOU BY</div>-->
                            <!--<div class="fl plm"><img style="width: 79px; height: 18px;" src="/res/img/school/overview/tandem/microsoft_logo_79x18.png" alt="MS OFFICE 365" /></div>-->
                            </div>
                        </div>
                    </c:if>
                </div>
            </div>

        </gslink:linkToTab>
    </div>
</jsp:root>