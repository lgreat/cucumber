/*
 * Copyright (c) 2005-2006 GreatSchools.org. All Rights Reserved.
 * $Id: DeleteNewsItemController.java,v 1.3 2009/12/04 20:00:23 npatury Exp $
 */

package gs.web.admin.news;

import gs.data.content.INewsItemDao;
import gs.data.content.NewsItem;
import gs.data.state.State;
import gs.web.util.UrlBuilder;
import gs.web.util.ReadWriteController;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.View;
import org.springframework.web.servlet.view.RedirectView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Provides...
 *
 * @author <a href="mailto:apeterson@greatschools.org">Andrew J. Peterson</a>
 */
public class DeleteNewsItemController implements ReadWriteController {

    private INewsItemDao newsItemDao;

    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws Exception {

        NewsItem item = newsItemDao.findNewsItem(Integer.parseInt(request.getParameter("id")));

        UrlBuilder builder = new UrlBuilder(UrlBuilder.ADMIN_NEWS_ITEMS, State.CA);
        builder.setParameter("message",
                "Deleted news item. " +
                        "<br /><br />Category: " + item.getCategory() + "<br />" + item.getText() + "");

        newsItemDao.removeNewsItem(item);

        View view = new RedirectView(builder.asSiteRelative(request));

        return new ModelAndView(view);
    }

    public INewsItemDao getNewsItemDao() {
        return newsItemDao;
    }

    public void setNewsItemDao(INewsItemDao newsItemDao) {
        this.newsItemDao = newsItemDao;
    }
}
